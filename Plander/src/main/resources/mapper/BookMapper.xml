<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//ibatis.apache.org//DTD Mapper 3.0//EN" "http://ibatis.apache.org/dtd/ibatis-3-mapper.dtd">
<mapper namespace="com.bit.mapper.BookMapper">
	
	<!-- 전체 좌석 수 확인 -->
	<select id="seatCnt" resultType="int" parameterType="Map">
		SELECT COUNT(S_COL) FROM SEATS WHERE BR_IDX = #{br_idx} AND SCT_IDX = #{sct_idx}
	</select>
	
	<!-- 예약된 좌석 수 -->
	<select id="bookSeatCnt" resultType="int">
		SELECT NVL(COUNT(*),0) FROM (
			SELECT B.*, S.BR_IDX, S.S_COL, S.SCT_IDX FROM BOOKING B, SEATS S
			WHERE B.S_IDX = S.S_IDX AND S.SCT_IDX = #{sct_idx} )
	</select>
	
	<!-- 예약된 좌석 조회 -->
	<select id="bookSeat" resultType="com.bit.domain.BookingVO">
		SELECT B.*, S.BR_IDX, S.S_COL, S.SCT_IDX FROM BOOKING B, SEATS S
		WHERE B.S_IDX = S.S_IDX AND S.SCT_IDX = #{sct_idx} ORDER BY B.BK_REGDATE
	</select>
	
	
	
	
	
	
	<!-- 방 조회 -->
	<select id="room" resultType="com.bit.domain.SeatsCategoryVO">
		SELECT * FROM SEAT_CATEGORY WHERE SCT_IDX = #{sct_idx}
	</select>
	
	<!-- 내 선택 정보 조회 -->
	<select id="myseat" resultType="com.bit.domain.BookingVO">
		SELECT B.*, S.BR_IDX, S.S_COL, S.SCT_IDX FROM BOOKING B, SEATS S
		WHERE B.S_IDX = S.S_IDX AND B.ID = #{id}
	</select>
	

</mapper>



